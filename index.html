<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë°˜ì‘ ì†ë„ ê²Œì„</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
        }
        #game-container {
            text-align: center;
        }
        #game-area {
            width: 300px;
            height: 300px;
            margin: 20px auto;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            font-size: 24px;
            color: white;
            font-weight: bold;
            background-color: blue;
        }
        #world-records {
            margin-top: 20px;
        }
        #world-records li {
            text-align: left;
            font-size: 18px;
            margin-bottom: 5px;
        }
        #nickname-form {
            margin-bottom: 20px;
        }
        input, button {
            font-size: 16px;
            padding: 5px 10px;
        }
    </style>
</head>
<body>
    <div id="game-container">
        <div id="nickname-form">
            <input type="text" id="nickname-input" placeholder="ë‹‰ë„¤ì„ì„ ì…ë ¥í•˜ì„¸ìš”">
            <button id="start-button">ê²Œì„ ì‹œì‘</button>
        </div>
        <div id="game-area" style="display: none;">í´ë¦­í•˜ì—¬ ì‹œì‘</div>
        <div id="world-records" style="display: none;">
            <h2>ì„¸ê³„ ê¸°ë¡</h2>
            <ol id="records-list"></ol>
        </div>
    </div>

    <script>
        let gameState = 'setup';
        let startTime = null;
        let worldRecords = [];
        let nickname = '';
        let changeTimeout = null;

        const gameArea = document.getElementById('game-area');
        const recordsList = document.getElementById('records-list');
        const nicknameForm = document.getElementById('nickname-form');
        const nicknameInput = document.getElementById('nickname-input');
        const startButton = document.getElementById('start-button');
        const worldRecordsDiv = document.getElementById('world-records');

        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ê¸°ë¡ ë¶ˆëŸ¬ì˜¤ê¸°
        function loadRecords() {
            const savedRecords = localStorage.getItem('reactionGameRecords');
            if (savedRecords) {
                worldRecords = JSON.parse(savedRecords);
                updateRecordsList();
            }
        }

        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ê¸°ë¡ ì €ì¥í•˜ê¸°
        function saveRecords() {
            localStorage.setItem('reactionGameRecords', JSON.stringify(worldRecords));
        }

        function startGame() {
            gameState = 'ready';
            gameArea.style.backgroundColor = 'blue';
            gameArea.innerHTML = 'ì´ˆë¡ìƒ‰ì„ ê¸°ë‹¤ë¦¬ì„¸ìš”...';
            const changeTime = Math.floor(Math.random() * 4000) + 1000; // 1ì´ˆì—ì„œ 5ì´ˆ ì‚¬ì´
            changeTimeout = setTimeout(() => {
                gameState = 'go';
                gameArea.style.backgroundColor = 'green';
                gameArea.innerHTML = 'í´ë¦­í•˜ì„¸ìš”!';
                startTime = Date.now();
            }, changeTime);
        }

        function handleGameAreaClick() {
            if (gameState === 'waiting') {
                startGame();
            } else if (gameState === 'ready') {
                clearTimeout(changeTimeout);
                gameState = 'waiting';
                gameArea.style.backgroundColor = 'red';
                gameArea.innerHTML = 'ë„ˆë¬´ ë¹¨ëì–´ìš”!<br>ë‹¤ì‹œ í´ë¦­í•˜ì—¬ ì‹œì‘í•˜ì„¸ìš”.';
            } else if (gameState === 'go') {
                const reactionTime = Date.now() - startTime;
                gameState = 'waiting';
                gameArea.style.backgroundColor = 'blue';
                gameArea.innerHTML = `ë°˜ì‘ ì‹œê°„: ${reactionTime}ms<br>ë‹¤ì‹œ í´ë¦­í•˜ì—¬ ì‹œì‘í•˜ì„¸ìš”`;
                updateWorldRecords(reactionTime);
            }
        }

        function updateWorldRecords(newScore) {
            worldRecords.push({ name: nickname, score: newScore });
            worldRecords.sort((a, b) => a.score - b.score);
            worldRecords = worldRecords.slice(0, 3); // ìƒìœ„ 3ê°œì˜ ê¸°ë¡ë§Œ ìœ ì§€
            updateRecordsList();
            saveRecords(); // ê¸°ë¡ ì—…ë°ì´íŠ¸ í›„ ì €ì¥
        }

        function updateRecordsList() {
            recordsList.innerHTML = '';
            worldRecords.forEach((record, index) => {
                const li = document.createElement('li');
                const medal = index === 0 ? 'ğŸ¥‡' : index === 1 ? 'ğŸ¥ˆ' : index === 2 ? 'ğŸ¥‰' : '';
                li.textContent = `${medal} ${record.name}: ${record.score}ms`;
                recordsList.appendChild(li);
            });
        }

        startButton.addEventListener('click', function(e) {
            e.preventDefault();
            nickname = nicknameInput.value.trim();
            if (nickname) {
                gameState = 'waiting';
                nicknameForm.style.display = 'none';
                gameArea.style.display = 'flex';
                worldRecordsDiv.style.display = 'block'; // ì„¸ê³„ ê¸°ë¡ì„ ë³´ì´ê²Œ í•¨
                gameArea.style.backgroundColor = 'blue';
                gameArea.innerHTML = 'í´ë¦­í•˜ì—¬ ì‹œì‘';
            }
        });

        gameArea.addEventListener('click', handleGameAreaClick);

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ê¸°ë¡ ë¶ˆëŸ¬ì˜¤ê¸°
        loadRecords();
    </script>
</body>
</html>
